<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">

<!-- Navigationbar -->
  <nav class="navbar navbar-expand-lg static-top">
    <div class="container">
      <a class="navbar-brand"><h3>Online Classic Commentary</h3></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li> <button class="btn btn-lg" (click)="open(textChanger)">Change Text</button></li>
          <li> <button class="btn btn-lg" (click)="openLg(bib1)">Bibliography</button></li>
          <li> <button class="btn btn-lg" (click)="open(newEntry)">New Entry</button></li>
          <!-- <li> <button class="btn btn-lg" (click)="putInArray()">Retrieve</button></li> -->
          <li> <button class="btn btn-lg" (click)="show = !show">3Columns</button></li>
          <!-- <li> <mat-button-toggle value="bold">Bold</mat-button-toggle></li> -->

        </ul>
      </div>
    </div>
  </nav>

<!-- Modals from the navigation bar -->
  <!-- Author and Book selection Modal #textChanger -->
  <ng-template #textChanger let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Select an Author and Book</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      Author:
      <div>
        <select class="dropbtn" [(ngModel)]="selectedAuthor" (ngModelChange)="requestBooks(selectedAuthor[0])">
          <option *ngFor="let c of this.authors" [ngValue]="c">{{c[1]}}</option>
        </select>
      </div>
      <br>
      Book:
      <div>
          <select class="dropbtn" [(ngModel)]="selectedBook" (ngModelChange)="requestPrimaryText(selectedBook[0])">
            <option *ngFor="let d of this.books" [ngValue]="d">{{d[1]}}</option>
          </select>
        </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Exit</button>
    </div>
  </ng-template>

  <!-- New Entry modal to add a custom piece of commentary -->
  <ng-template #newEntry let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Add an entry.</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div>
        Remember to use HTML formatting for bold and italics! <br>
        <form #f="ngForm" (ngSubmit)="onSubmit(f)" novalidate>
            lineBegin: <input name="first" ngModel required #first="ngModel"> <br>
            lineEnd: <input name="last" ngModel> <br>
            Words: <input name="last" ngModel> <br>
            Commentary: <input name="last" ngModel> <br>
            Source: <input name="last" ngModel> <br>
            <button>Submit</button>
          </form>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Save</button>
    </div>
  </ng-template>

  <!-- Bibliography Modal to show the used bibliography -->
  <ng-template #bib1 let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Bibliography</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div>
          <mat-nav-list class="my-list-2">
              <mat-list-item *ngFor="let line of this.bib">
                <b>{{ line[0] }} {{ line[1] }} </b> <pre> </pre> <i> {{ line[2] }} {{ line[3] }},</i><pre> </pre>{{ line[4] }} ({{ line[5] }}). {{ line[6] }} {{ line[7] }} - ({{ line[8] }}, {{ line[9] }})
              </mat-list-item>
            </mat-nav-list>
      </div>
    </div>
    <div class="modal-footer">
      <!-- <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Save</button> -->
    </div>
  </ng-template>

  <mat-progress-bar mode="query" *ngIf="spinner"></mat-progress-bar>
  <!-- <hr *ngIf="spinner == false"> -->


<br>

  <!-- Container for the page: one row, two columns. Column Left has the text, Column Right the commentary. -->


  <div class="container-fluid">
    <div class="row">
      <!-- Eerste Colom -->
      <div class="col-sm anyClass">


        <div class="example-list">
          <div class="example-box" *ngFor="let arrayItem of mainEditorArray" (click)="ophalenCommentaren(arrayItem.number, arrayItem.editor)">
            <div><b>{{arrayItem.number}}</b></div>
            <div [innerHTML]="arrayItem.line"></div>      
          </div> 
        </div> 

        <!-- <ul class="fragment-ul" *ngFor="let arrayItem of mainEditorArray" (click)="ophalenCommentaren(arrayItem.number, arrayItem.editor)">
          <li class="fragment-li">
            <div class="row">
              <div class="column1"><b>{{arrayItem.number}}  </b></div>
              <div class="column1" [innerHTML]="arrayItem.line"></div>
            </div>                   
          </li>
        </ul> -->
      </div>

      <!-- Tweede column. Gets toggle via variable show. -->
      <div *ngIf="show" class="col-sm anyClass">

        <mat-form-field>
            <mat-label>Select editor</mat-label>
            <mat-select [(ngModel)]="selected2">
                <mat-option *ngFor="let selectedEditor of this.editors" [value]="selectedEditor[1]"
                (click)="opbouwenFragmentenEditor(selectedEditor[0], 2)">
                {{ selectedEditor[1] }} 
                  
                </mat-option>
              </mat-select>
        </mat-form-field>

        <div>

          </div>


        <div cdkDropList class="example-list" (cdkDropListDropped)="drop1($event)">
          <div class="example-box" *ngFor="let arrayItem of selectedEditorArray" cdkDrag>
          <!-- <p><b>{{arrayItem.number}}</b></p>
              <div [innerHTML]="arrayItem.line"></div> -->
            <div><b>{{arrayItem.number}}</b></div>
              <div [innerHTML]="arrayItem.line"></div>
         </div>
        </div>
      </div>

    <!-- Derde column -->
      <div class="col-sm">
        <div class="col-sm anyClass">
          <!-- <mat-spinner *ngIf="spinner"></mat-spinner> -->
          <!-- Empty Entry -->
          <!-- <div *ngIf="checkEmptyBlock(this.F_commentaar)">No entry found.</div> -->
          <!-- Valid Entry -->

          <!-- <mat-spinner></mat-spinner> -->

          <div *ngFor="let AppCrit of this.F_AppCrit">
            <mat-expansion-panel>
              <!-- Regelnummer -->
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <b>Apparatus Criticus</b>
                </mat-panel-title>
              <!-- Woorden in kwestie -->
                <!-- <b>Latin is great</b> -->
              </mat-expansion-panel-header>
              <!-- Commentaar zelf met opmaak -->
              <div class="mat-expansion-panel-content">
                <div class="mat-expansion-panel-body">
                  <div [innerHTML]=AppCrit></div>
                </div>
              </div>
            </mat-expansion-panel>
          </div>

          <hr>

          <div *ngFor="let differences of this.F_Differences">
            <!-- {{commentaar}} -->
            <mat-expansion-panel>
              <!-- Regelnummer -->
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <b>Fragment Differences</b>
                </mat-panel-title>
              <!-- Woorden in kwestie -->
                <!-- <b>Latin is great</b> -->
              </mat-expansion-panel-header>
              <!-- Commentaar zelf met opmaak -->
              <div class="mat-expansion-panel-content">
                <div class="mat-expansion-panel-body">
                    <div [innerHTML]="differences"></div>
                </div>
              </div>
            </mat-expansion-panel>
          </div>

          <hr>



        <div *ngFor="let F_Context of this.F_Context">
          <!-- {{commentaar}} -->
          <mat-expansion-panel>
            <!-- Regelnummer -->
            <mat-expansion-panel-header>
              <mat-panel-title>
                <b>Fragment Context</b>
              </mat-panel-title>
            <!-- Woorden in kwestie -->
              <div [innerHTML]="F_Context[0]"></div>
            </mat-expansion-panel-header>
            <!-- Commentaar zelf met opmaak -->
            <div class="mat-expansion-panel-content">
              <div class="mat-expansion-panel-body">
                  <div [innerHTML]="F_Context[1]"></div>
              </div>
            </div>
          </mat-expansion-panel>
        </div>
        
        <hr>

        <div *ngFor="let commentaar of this.F_Commentaar">
          <!-- {{commentaar}} -->
          <mat-expansion-panel>
            <!-- Regelnummer -->
            <mat-expansion-panel-header>
              <mat-panel-title>
                <b>Fragment Commentary</b>
              </mat-panel-title>
            <!-- Woorden in kwestie -->
              <!-- <b>Latin is great</b> -->
            </mat-expansion-panel-header>
            <!-- Commentaar zelf met opmaak -->
            <div class="mat-expansion-panel-content">
              <div class="mat-expansion-panel-body">
                  <div [innerHTML]="commentaar"></div>
              </div>
            </div>
          </mat-expansion-panel>
        </div>

      <hr>

      <div *ngFor="let translation of this.F_Translation">
        <!-- {{commentaar}} -->
        <mat-expansion-panel>
          <!-- Regelnummer -->
          <mat-expansion-panel-header>
            <mat-panel-title>
              <b>Fragment Translation</b>
            </mat-panel-title>
          <!-- Woorden in kwestie -->
            <!-- <b>Latin is great</b> -->
          </mat-expansion-panel-header>
          <!-- Commentaar zelf met opmaak -->
          <div class="mat-expansion-panel-content">
            <div class="mat-expansion-panel-body">
                <div [innerHTML]="translation"></div>
            </div>
          </div>
        </mat-expansion-panel>
      </div>
            <!-- </div> -->
        <!-- </div>

      </div> -->
  <!-- </div>
  </div> -->

  <!-- Extra row for some quick testing! -->
  <!-- <div class="container-fluid">
      <div class="row">
        <div class="col-sm anyClass">
            <mat-nav-list class="my-list-2">
              <mat-list-item *ngFor="let line of this.bib">
                {{line[0]}}-{{line[1]}}
              </mat-list-item>
            </mat-nav-list>
        </div>
        <div class="col-sm anyClass">
            <button (click)="requestBibliography()">Hello</button>
            <div class="list" ng-repeat="thing in this.bib">
                {{ thing }}
              </div>
        </div>
    </div> -->

