<!-- I think this can be removed. -->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">

<!-- Maybe we should get a local stylesheet? -->
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<!-- Simple toolbar with all the different buttons and the title -->
<mat-toolbar color="primary">
    <span><h3 class='h3-title'>Dashboard</h3></span>
</mat-toolbar>

<!-- Show a spinner if query with database is in progress -->
<mat-progress-bar mode="query" *ngIf="this.spinner"></mat-progress-bar>
<br>

<button mat-button (click)="Test('hoi')">Add Note</button>


<div class="div-padding"></div>

<!-- SELECTING ROW -->
<div class="container-fluid">
    <div class="row">
        <!-- Need some space here please  -->
        <mat-form-field class="select-form">
            <mat-label>Author</mat-label>
            <mat-select [(ngModel)]="selectedAuthor">
                <mat-option *ngFor="let data of this.authorsJSON" [value]="data"
                (click)="RequestBooks(data.id)">
                {{ data.name }}                       
                </mat-option>
            </mat-select>
            <mat-hint>Select an author</mat-hint>
        </mat-form-field>
    
        <mat-form-field class="select-form">
            <mat-label>Book</mat-label>
            <mat-select [(ngModel)]="selectedBook">
            <mat-option *ngFor="let data of this.booksJSON" [value]="data"
            (click)="this.RequestEditors(data.id)"
            (click)="this.RequestFragments(data.id)">
                {{ data.title }}                       
            </mat-option>
            </mat-select>
            <mat-hint>Select a book</mat-hint>
        </mat-form-field>
    
        <mat-form-field class="select-form">
            <mat-label>Editor</mat-label>
            <mat-select [(ngModel)]="selectedEditor">
            <mat-option *ngFor="let data of this.editorsJSON" [value]="data"
            (click)="this.selectedEditorArray = CreateEditorArray(data.id, this.F_Fragments)"
            (click)="this.fragmentNumberList = GetFragmentNumbers(data.id, this.selectedEditorArray)">
                {{ data.name }}                       
            </mat-option>
            </mat-select>
            <mat-hint>Select an editor</mat-hint>
        </mat-form-field>
            
        <mat-form-field class="select-form">
            <mat-label>Fragment</mat-label>
            <mat-select [(ngModel)]="selectedFragment">
            <mat-option *ngFor="let data of this.fragmentNumberList" [value]="data"
            (click)="this.selectedLine = ''" 
            (click)="fragmentLineContent = ''"
            (click)="selectedLineStatus = ''"
            (click)="this.RequestReferencerID(this.selectedFragment, this.selectedEditor.id, this.selectedBook.id)"
            (click)="this.lineNumberList = GetLineNumbers(data, this.selectedEditorArray)">
                {{ data }} 
            </mat-option>
            </mat-select>
            <mat-hint>Select a fragment</mat-hint>
        </mat-form-field>      
        
        <mat-form-field class="select-form">
            <mat-label>Line</mat-label>
            <mat-select [(ngModel)]="selectedLine">
            <mat-option *ngFor="let data of this.lineNumberList" [value]="data"
            (click)="this.fragmentLineContent = GetFragmentLine(data, this.selectedFragment, this.selectedEditorArray)">
                {{ data }} 
            </mat-option>
            </mat-select>
            <mat-hint>Select a line</mat-hint>
        </mat-form-field>            
    </div>
</div>

<hr>

<!-- TAB GROUPS TO ENTER DATA -->
<div class="container-fluid">
    <div class="row">
        <mat-tab-group>
            <mat-tab label="Add/Remove Items"><br>
                <!-- Group to add/remove Authors, Books and Editors -->
                <mat-tab-group>
                  <!-- Tab to add/remove Authors -->
                    <mat-tab label="Author"><br>
                        <div mat-dialog-content>
                        <mat-form-field class="input-form">
                            <input matInput placeholder="Add author" [(ngModel)]='inputAuthor'>
                            <mat-hint>Fill in the name of a new author</mat-hint>
                        </mat-form-field>
                        </div>  
            
                        <br>
                        <button mat-button (click)="RequestCreateAuthor(inputAuthor)">Create added author</button>
                        <button mat-button (click)="RequestDeleteAuthor(this.selectedAuthor.id)">Delete selected author</button>
                    </mat-tab>
        
                    <!-- Tab to add/remove Books -->
                    <mat-tab label="Book"><br>
            
                        <div mat-dialog-content>
                        <mat-form-field class="input-form">
                            <input matInput placeholder="Add book" [(ngModel)]='inputBook'>
                            <mat-hint>Select an author and fill in the name of his/her new book</mat-hint>
                        </mat-form-field>
                        </div>  
            
                        <br>
                        <button mat-button (click)="RequestCreateBook(inputBook, this.selectedAuthor.id)">Create added book</button>
                        <button mat-button (click)="RequestDeleteBook(this.selectedBook.id, this.selectedAuthor.id)">Delete selected book</button>
                    </mat-tab>
        
                    <!-- Tab to add/remove Editors -->
                    <mat-tab label="Editor"><br>         
                        <div mat-dialog-content>
                        <mat-form-field class="input-form">
                            <input matInput placeholder="Add editor" [(ngModel)]='inputEditor'>
                            <mat-hint>Select an author and book and fill in the name of its new editor</mat-hint>
                        </mat-form-field>
                        </div>  
                        <br>
                        <button mat-button (click)="RequestCreateEditor(inputEditor, this.selectedBook.id, this.selectedAuthor.id)">Create added editor</button>
                        <button mat-button (click)="RequestDeleteEditor(this.selectedEditor.id, this.selectedBook.id, this.selectedAuthor.id)">Delete selected editor</button>
                        <button mat-button (click)="RequestSetMainEditor(this.selectedEditor.id, this.selectedBook.id, this.selectedAuthor.id)">Set selected editor as main editor</button>
                        <button mat-button (click)="RequestDeleteMainEditor(this.selectedEditor.id, this.selectedBook.id, this.selectedAuthor.id)">Remove selected editor as main editor</button>
            
                    </mat-tab>
                </mat-tab-group>
            </mat-tab>
        
            <mat-tab label="Create/Revise Fragment"><br> 
                <form [formGroup]="fragmentForm" (ngSubmit)="RequestCreateFragment(fragmentForm.value, this.selectedEditor.id, this.selectedBook.id)">
                  
                  <mat-form-field class="input-form-full-width">
                    <mat-label>Fragment number</mat-label>
                    <input matInput value='{{this.selectedFragment}}' id="inputFragmentNumber" type="text" formControlName="inputFragmentNumber" required>
                    <mat-hint>Provide the revised line of the selected fragment line</mat-hint>                       
                  </mat-form-field>

                  <mat-form-field class="input-form-full-width">
                    <mat-label>Line number</mat-label>
                    <input matInput value='{{this.selectedLine}}' id="inputLineNumber" type="text" formControlName="inputLineNumber" required>
                    <mat-hint>Provide the revised line of the selected fragment line</mat-hint>                       
                  </mat-form-field>

                  <mat-form-field class="input-form-full-width">
                    <mat-label>Line content</mat-label>
                    <input matInput value='{{this.fragmentLineContent}}' id="inputLineContent" type="text" formControlName="inputLineContent" required>
                    <mat-hint>Provide the revised line of the selected fragment line</mat-hint>                       
                  </mat-form-field>

                  <mat-form-field class="input-form-full-width">
                    <mat-label>Line status</mat-label>
                    <input matInput value='{{this.selectedLineStatus}}' id="inputLineStatus" type="text" formControlName="inputLineStatus">
                    <mat-hint>Provide the revised line of the selected fragment line</mat-hint>                       
                  </mat-form-field>



                  <button mat-button class="button" type="submit">Update Fragment</button>
                </form>
                <br>
                <button mat-button (click)="RequestDeleteFragment(this.selectedEditor.id, this.selectedBook.id, this.selectedFragment)">Deleted selected Fragment</button>

              </mat-tab>

            <!-- Tab Group to change a fragment. -->

            <mat-tab label="Create/Revise Content"><br>
                <h4>Select one of the fragments to change its contents fields. Only changes will be saved.</h4>
                <!-- Uses form group! On pressing upload, changes will be put in the form. -->
                <form [formGroup]="contentForm" (ngSubmit)="RequestReviseContent(contentForm.value)">
                                                        
                  <mat-form-field class="input-form-full-width">
                    <mat-label>Fragment translation</mat-label>
                    <input matInput value='{{translationContent}}' id="inputTranslation" type="text" formControlName="inputTranslation">
                    <mat-hint>Provide the revised translation of the selected fragment</mat-hint>                       
                  </mat-form-field>
                  
                  <mat-form-field class="input-form-full-width">
                    <mat-label>Fragment apparatus criticus</mat-label>
                    <input matInput value='{{apparatusContent}}' id="inputApparatus" type="text" formControlName="inputApparatus">
                    <mat-hint>Provide the revised apparatus criticus of the selected fragment</mat-hint>                       
                  </mat-form-field>
                                  
                  <mat-form-field class="input-form-full-width">
                    <mat-label>Fragment differences</mat-label>
                    <input matInput value='{{differencesContent}}' id="inputDifferences" type="text" formControlName="inputDifferences">
                    <mat-hint>Provide the revised differences of the selected fragment</mat-hint>                       
                  </mat-form-field>

                  <mat-form-field class="input-form-full-width">
                    <mat-label>Fragment commentary</mat-label>
                    <input matInput value='{{commentaryContent}}' id="inputCommentary" type="text" formControlName="inputCommentary">
                    <mat-hint>Provide the revised commentary of the selected fragment</mat-hint>                       
                  </mat-form-field>

                  <mat-form-field class="input-form-full-width">
                    <mat-label>Fragment reconstruction</mat-label>
                    <input matInput value='{{reconstructionContent}}' id="inputReconstruction" type="text" formControlName="inputReconstruction">
                    <mat-hint>Provide the revised reconstruction of the selected fragment</mat-hint>                       
                  </mat-form-field>                  
                  

                  <!-- Button is linked via the submit type! -->
                  <br><br>
                  <button mat-button class="button" type="submit">Upload</button>
                </form>
              </mat-tab>
                    
              <!-- Tab to fix the context: select author and change its content. -->
              <mat-tab label="Revise/Create context"><br>
                <h4>Select one of the fragments to change its context fields.</h4>

                <mat-form-field class="input-form">
                  <mat-label>Fragment context author</mat-label>
                  <mat-select>
                    <mat-option *ngFor="let item of this.F_Context" [value]="item.id"
                    (click)="SelectCorrespondingContext(item)">                  
                      {{ item.contextAuthor }}                       
                    </mat-option>
                  </mat-select>
                  <mat-hint>Select the author of the requested context for the selected fragment</mat-hint>
                </mat-form-field>
                <div class="div-padding"></div>

                <form [formGroup]="contextForm" (ngSubmit)="RequestReviseContext(contextForm.value)">

                  <mat-form-field class="input-form-full-width">
                    <mat-label>Context Author</mat-label>
                    <input matInput value='{{this.inputContextAuthor}}' id="inputContextAuthor" type="text" formControlName="inputContextAuthor" required>
                    <mat-hint>Provide the revised commentary of the selected fragment</mat-hint>                       
                  </mat-form-field>                  

                  <mat-form-field class="input-form-full-width">
                    <mat-label>Context</mat-label>
                    <input matInput value='{{this.inputContext}}' id="inputContext" type="text" formControlName="inputContext" required>
                    <mat-hint>Provide the revised commentary of the selected fragment</mat-hint>                       
                  </mat-form-field>             
                  
                  <!-- Button is linked via the submit type! -->
                  <div class="div-padding"></div>

                  <button mat-button class="button" type="submit">Upload</button>
                </form>                




              </mat-tab>

              <mat-tab label="Publish"><br>
                <button mat-button (click)="this.RequestPublishFlag(this.selectedEditor.id, this.selectedBook.id, this.selectedFragment, 1)">Publish selected fragment</button>
                <button mat-button (click)="this.RequestPublishFlag(this.selectedEditor.id, this.selectedBook.id, this.selectedFragment, 0)">Unpublish selected fragment</button>
            </mat-tab>

            

        </mat-tab-group>
        

    </div>
</div>