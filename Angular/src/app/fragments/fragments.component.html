<!-- I think this can be removed. -->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">

<!-- Maybe we should get a local stylesheet? -->
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<!-- Simple toolbar with all the different buttons and the title -->
<mat-toolbar color="primary">
    <span><h3 class='h3-title'>Online Fragment Commentary</h3></span>
    <span class="spacer"></span>
    <button mat-button class="btn" (click)="OpenBookSelect()">CHANGE TEXT</button>
    <button mat-button class="btn" (click)="OpenBibliography()">BIBLIOGRAPHY</button>
    <button mat-button class="btn" routerLink="/dashboard">DASHBOARD</button>
    <button mat-button class="btn" (click)="columnsToggle = !columnsToggle">3COLUMNS</button>
    <button mat-button class="btn" [matMenuTriggerFor]="menu">MENU</button>
</mat-toolbar>
<!-- Small menu for the toolbar -->
<mat-menu #menu="matMenu">
    <!-- <button routerLink="/text" mat-menu-item>Text OSCC</button> -->
    <!-- <button routerLink="/login" mat-menu-item>Playroom</button> -->
    <!-- <button routerLink="/profile" mat-menu-item>Playroom2</button> -->
    <button (click)="OpenAbout()" mat-menu-item>About</button>
</mat-menu>
         
<!-- Author and Book select dialog -->
<ng-template #CallBookSelect>   
    <h3>Select an author and a book to display.</h3>
    <hr>
    <mat-form-field>
        <mat-label>Select author</mat-label>
        <mat-select>
        <mat-option *ngFor="let author of this.authorsJSON" [value]="author" 
            (click)="this.RequestBooks(author.id)" 
            (click)="this.SetCurrentAuthorData(author)">
            {{ author.name }} 
        </mat-option>
        </mat-select>  
    </mat-form-field> 
    
    <mat-form-field>
        <mat-label>Select book</mat-label>
        <mat-select>
        <mat-option *ngFor="let book of this.booksJSON" [value]="book" 
            (click)="RequestEditors(book.id)"
            (click)="RequestFragments(book.id)"
            (click)="SetCurrentBookData(book)">
            {{ book.title }}                
        </mat-option>
        </mat-select>
    </mat-form-field>    
</ng-template>

<!-- Bibliography dialog to show the used bibliography -->
<ng-template #CallBibliography>   
    <h3>Bibliography for {{this.currentAuthorName}}: {{this.currentBookName}}</h3>
    <hr>
    <h4>Books</h4>
    <mat-nav-list class="bibList">
        <mat-list-item *ngFor="let line of this.bibBooks">
        <b>{{ line[1] }}</b> &nbsp; <i>{{ line[2] }}.</i> &nbsp; ({{ line[8] }}, {{ line[9] }}).
        </mat-list-item>
    </mat-nav-list>
    <hr>
    <h4>Articles</h4>
    <mat-nav-list class="bibList">
        <mat-list-item *ngFor="let line of this.bibArticles">
        <b>{{ line[1] }}</b> &nbsp; "{{ line[3] }}". In: &nbsp; <i>{{ line[4] }}</i> &nbsp; {{ line[5] }}, &nbsp; ({{ line[8] }}, {{ line[9] }}), {{ line[7] }}.
        </mat-list-item>
    </mat-nav-list>
    <hr>
    <h4>Websites</h4>
    <mat-nav-list class="bibList">
        <mat-list-item *ngFor="let line of this.bibWebsites">
        <b>{{ line[10] }}.</b> &nbsp; URL: {{ line[11] }} &nbsp; (visited on {{ line[12] }})
        </mat-list-item>
    </mat-nav-list>
</ng-template>

<!-- Show a spinner if query with database is in progress -->
<mat-progress-bar mode="query" *ngIf="this.spinner"></mat-progress-bar>
<br>

<!-- Container for the page: one row, two columns. Column Left has the text, Column Right the commentary. -->
<div class="container-fluid">
    <div class="row">
        <!-- FIRST COLUMN -->
        <div class="col-sm overflowColumn">
        <div class="row">
            <div class="col-6">
            <h4>{{this.currentAuthorName}}: {{this.currentBookName}}.</h4>
            </div>  
            <div class="col-6">
            <mat-form-field>
                <mat-label>Select main editor</mat-label>
                <mat-select>
                <mat-option *ngFor="let mainEditor of this.mainEditorsJSON" [value]="mainEditor.Name"
                (click)="this.mainEditorArray = CreateEditorArray(mainEditor.id, this.F_Fragments)"
                (click)="this.SetCurrentEditorData(mainEditor)">
                    {{ mainEditor.name }}                     
                </mat-option>
                </mat-select>
            </mat-form-field>
            </div>
        </div>
        <!-- Listing of the fragments -->
        <div class="fragment-list">
            <div class="fragment-box" *ngFor="let arrayItem of this.mainEditorArray" 
            (click)="this.Referencer = this.RequestReferencerID(arrayItem.fragmentName, this.currentEditor, this.currentBook)">
            <div>
                <b>Fragment {{arrayItem.fragmentName}} </b> &nbsp; <i>{{arrayItem.status}}</i>
            </div>
            <div *ngFor="let arrayItem2 of arrayItem.content">           
                <div [innerHTML]="arrayItem2.lineComplete"></div>             
            </div>     
            </div> 
        </div> 
        </div>
    
        <!-- SELECTED EDITOR COLUMN -->
        <div *ngIf="columnsToggle" class="col-sm overflowColumn">
        <div class="row">
            <div class="col-6">
            <mat-form-field>
                <mat-label>Select secondary editor</mat-label>
                <mat-select>
                <mat-option *ngFor="let selectedEditor of this.editorsJSON" [value]="selectedEditor.id"
                (click)="this.selectedEditorArray = CreateEditorArray(selectedEditor.id, this.F_Fragments)">
                    {{ selectedEditor.name }} 
                </mat-option>
                </mat-select>
            </mat-form-field>
            </div>
        </div>
    
        <!-- Movable array column -->
        <div cdkDropList class="fragment-list" (cdkDropListDropped)="moveAndDrop($event)">
            <div class="fragment-box" *ngFor="let arrayItem of this.selectedEditorArray" cdkDrag>
            <div>
                <b>Fragment {{arrayItem.fragmentName}}</b> &nbsp; <i>{{arrayItem.status}}</i>
            </div>
            <div *ngFor="let arrayItem2 of arrayItem.content">           
                <div [innerHTML]="arrayItem2.lineComplete"></div> 
            </div>  
            </div>
        </div>
        </div>
    
        <!-- COMMENTARY COLUMN -->
        <div class="col-sm overflowColumn">
        <h4>Fragment {{this.currentFragment}}</h4> <hr>
        <!-- Show banner if no commentary available -->
        <div *ngIf="this.noCommentary" class="alert alert-info" role="alert">
            No commentary is available for this fragment.
        </div>
        <div *ngIf="this.noCommentary === false">
            <div *ngFor="let item of this.F_Translation">
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                    <mat-panel-title>
                        <b>Fragment Translation</b>
                    </mat-panel-title>
                    </mat-expansion-panel-header>
                    <!-- Commentary with HTML formatting. -->
                    <div class="mat-expansion-panel-content">
                    <div class="mat-expansion-panel-body">
                        <div [innerHTML]="item.translation"></div>
                    </div>
                    </div>
                </mat-expansion-panel>
            </div>
    
            <hr>
    
            <div *ngFor="let item of this.F_Apparatus">
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                    <mat-panel-title>
                        <b>Apparatus Criticus</b>
                    </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="mat-expansion-panel-content">
                    <div class="mat-expansion-panel-body">
                        <div [innerHTML]=item.apparatus></div>
                    </div>
                    </div>
                </mat-expansion-panel>
            </div>
    
            <hr>
    
            <div *ngFor="let item of this.F_Differences">
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                    <mat-panel-title>
                        <b>Fragment Differences</b>
                    </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="mat-expansion-panel-content">
                    <div class="mat-expansion-panel-body">
                        <div [innerHTML]="item.differences"></div>
                    </div>
                    </div>
                </mat-expansion-panel>
            </div>
    
            <hr>
    
            <div *ngFor="let item of this.F_Context">
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                    <mat-panel-title>
                        <b>Fragment Context</b>
                    </mat-panel-title>
                    <div [innerHTML]="item.contextAuthor"></div>
                    </mat-expansion-panel-header>
                    <div class="mat-expansion-panel-content">
                    <div class="mat-expansion-panel-body">
                        <div [innerHTML]="item.context"></div>
                    </div>
                    </div>
                </mat-expansion-panel>
            </div>
            
            <hr>
    
            <div *ngFor="let item of this.F_Commentary">
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                    <mat-panel-title>
                        <b>Fragment Commentary</b>
                    </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="mat-expansion-panel-content">
                    <div class="mat-expansion-panel-body">
                        <div [innerHTML]="item.commentary"></div>
                    </div>
                    </div>
                </mat-expansion-panel>
            </div>
    
            <hr>
    
            <div *ngFor="let item of this.F_Reconstruction">
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                    <mat-panel-title>
                        <b>Fragment Reconstruction</b>
                    </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="mat-expansion-panel-content">
                    <div class="mat-expansion-panel-body">
                        <div [innerHTML]="item.reconstruction"></div>
                    </div>
                    </div>
                </mat-expansion-panel>
            </div>
        </div>
        </div>
    </div>
</div>
    
    
    