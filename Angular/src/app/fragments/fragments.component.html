<!-- I think this can be removed. -->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">

<!-- Maybe we should get a local stylesheet? -->
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<!-- Navigation bar -->
<mat-toolbar color="primary">
    <span><h3 class='h3-title'>Open Source Classics Commentary</h3></span>
    <span class="spacer"></span>
    <button mat-button class="btn" (click)="this.OpenBookSelect()">CHANGE TEXT</button>
    <!-- <button mat-button class="btn" (click)="OpenBibliography()">BIBLIOGRAPHY</button> -->
    <button mat-button class="btn" routerLink="/dashboard" *ngIf="this.authService.isLoggedIn">DASHBOARD</button>
    <mat-checkbox class="btn" [(ngModel)]="columnOneToggle">COM</mat-checkbox>
    <mat-checkbox class="btn" [(ngModel)]="columnTwoToggle">SEC</mat-checkbox>
    <mat-checkbox class="btn" [(ngModel)]="playground_column">PLY</mat-checkbox>
    <mat-checkbox class="btn" [(ngModel)]="multiplayer_column">MUL</mat-checkbox>
    <mat-checkbox class="btn" [(ngModel)]="fourColumnMode">4COL</mat-checkbox>
    <button mat-button class="btn" [matMenuTriggerFor]="menu">MENU</button>
</mat-toolbar>

<!-- Navigation bar menu -->
<mat-menu #menu="matMenu">
    <button routerLink="/text" mat-menu-item>Text OSCC</button>
    <button routerLink="/scansion" mat-menu-item>Scansion</button>

    <a href="http://oscc.nolden.biz/Documentation/" target='_blank' mat-menu-item>Documentation</a>  
    <!-- <button (click)="OpenText()" mat-menu-item>Text Inside</button> -->
    <!-- <button (click)="Test('thing')" mat-menu-item>Test</button> -->
    <button (click)="Login()" mat-menu-item>Login</button>
    <button (click)="this.dialog.OpenAbout()" mat-menu-item>About</button>
    <!-- <button (click)="ngOnInit()" *ngIf="this.authService.isLoggedIn">Reload Data</button> -->
    <button mat-menu-item>V21.7.1</button>
</mat-menu>

<!-- Change text dialog -->
<ng-template #CallBookSelect>   
    <h3>Select an author and a text to display.</h3>
    <hr>
    <mat-form-field>
        <mat-label>Select author</mat-label>
        <mat-select>
            <mat-option *ngFor="let author of this.authorsJSON" [value]="author" 
                (click)="this.RequestBooks(author.id)" 
                (click)="this.SetCurrentAuthorData(author)">
                {{ author.name }} 
            </mat-option>
        </mat-select>  
    </mat-form-field> 
    
    <mat-form-field>
        <mat-label>Select text</mat-label>
        <mat-select>
            <mat-option *ngFor="let book of this.booksJSON" [value]="book" 
                (click)="RequestEditors(book.id)"
                (click)="RequestFragments(book.id)"
                (click)="SetCurrentBookData(book)">
                {{ book.title }}                
            </mat-option>
        </mat-select>
    </mat-form-field>    
</ng-template>

<!-- Show a spinner if query with database is in progress -->
<mat-progress-bar mode="query" *ngIf="this.spinner"></mat-progress-bar>
<br>

<!-- Container for the page. One row per item (commentary, playground, multiplayer, etc.) -->
<div class="container-fluid">
    <div class="row">
        
        <!-- First column, containing the fragments from the edition of reference -->
        <div *ngIf="columnOneToggle" class="col-sm overflowColumn">
            <!-- Text information and edition of reference selection -->
            <div class="row">
                <div class="col-6">
                    <h4>{{this.currentAuthorName}}: {{this.currentBookName}}.</h4>
                </div>  
                <div class="col-6">
                    <mat-form-field class="input-form">
                        <mat-label>Edition of Reference</mat-label>
                        <mat-select>
                            <mat-option *ngFor="let mainEditor of this.mainEditorsJSON" [value]="mainEditor.id"
                                (click)="this.mainEditorArray = CreateEditorArray(mainEditor, this.F_Fragments)"
                                (click)="this.SetCurrentEditorData(mainEditor)">
                                {{ mainEditor.name }}                     
                            </mat-option>
                        </mat-select>
                        <mat-hint>Select an edition of reference</mat-hint>
                    </mat-form-field>
                </div>
            </div>
            <!-- Fragments loop to display all fragments of the chosen edition of reference -->
            <div class="fragment-list">
                <div class="fragment-box" *ngFor="let arrayItem of this.mainEditorArray" 
                    (click)="this.Referencer = this.RequestReferencerID(arrayItem.fragmentName, this.currentEditor, this.currentBook)">
                    <div>
                        <b>Fragment {{arrayItem.fragmentName}} </b> &nbsp; <sup>{{arrayItem.author}}, {{arrayItem.text}}, {{arrayItem.editor}}</sup> &nbsp; <i>{{arrayItem.status}}</i>
                    </div>
                    <div *ngFor="let arrayItem2 of arrayItem.content">           
                        <div [innerHTML]="arrayItem2.lineComplete | safeHtml"></div> <!-- safeHtml to allow whitespaces -->            
                    </div>     
                </div> 
            </div> 
        </div>

        <!-- Second column, containing the fragments from other editions (these are movable) -->                                
        <div *ngIf="columnTwoToggle" class="col-sm overflowColumn">
            <div class="row">
                <!-- Editor selection -->
                <div class="col-md-6">
                    <mat-form-field class="input-form">
                        <mat-label>Secondary editor</mat-label>
                            <mat-select>
                                <mat-option *ngFor="let selectedEditor of this.editorsJSON" [value]="selectedEditor.id"
                                    (click)="this.selectedEditorArray = CreateEditorArray(selectedEditor, this.F_Fragments)">
                                    {{ selectedEditor.name }} 
                                </mat-option>
                            </mat-select>
                        <mat-hint>Select a secondary editor</mat-hint>
                    </mat-form-field>
                </div>
                <!-- Possibility of adding notes -->
                <div class="col-md-6">
                    <div mat-dialog-content>
                        <mat-form-field class="input-form">
                            <input matInput placeholder="Note" [(ngModel)]='note'>
                                <button type="button" mat-icon-button matSuffix (click)="this.noteArray = this.utility.PopArray(this.noteArray)">
                                    <mat-icon>{{'remove'}}</mat-icon>
                                </button>
                                <button type="button" mat-icon-button matSuffix (click)="this.noteArray = this.utility.PushToArray(note, this.noteArray)">
                                    <mat-icon>{{'add'}}</mat-icon>
                                </button>
                            <mat-hint>Add a note</mat-hint>
                        </mat-form-field>               
                    </div> 
                </div>
            </div>
            <!-- Printing of notes -->
            <div *ngFor="let note of this.noteArray" class="note" cdkDrag>
                {{note}}
            </div>

            <!-- For loop for moveable fragments. (should be clickable for more information) -->
            <div cdkDropList class="fragment-list" (cdkDropListDropped)="this.utility.moveAndDrop($event, this.selectedEditorArray)">
                <div class="fragment-box" *ngFor="let arrayItem of this.selectedEditorArray" 
                    (click)="this.utility.Test('hi')" cdkDrag>
                    <div> 
                        <!-- TODO: Show editor name behind fragment. Also, show its relation to the TRF. When clicked,
                        load the commentaries for this fragment and that of the corresponding TRF fragment. -->
                        <b>Frg {{arrayItem.fragmentName}}</b> &nbsp; <sup>{{arrayItem.author}}, {{arrayItem.text}}, {{arrayItem.editor}}</sup> &nbsp; <i>{{arrayItem.status}}</i>
                    </div>
                    <div *ngFor="let arrayItem2 of arrayItem.content">           
                        <div [innerHTML]="arrayItem2.lineComplete"></div> 
                    </div>  
                </div>
            </div>
        </div>
    
        <!-- Column with commentary, shown if a fragment from the edition of reference is clicked -->
        <div *ngIf="columnOneToggle" class="col-sm overflowColumn">
            <!-- TODO: Show here the commentary that is available for the COL2 clicked fragment -->

            <!-- Fragment information -->
            <h4>Fragment {{this.currentFragment}}</h4> <hr>
            <!-- Show banner if no commentary available -->
            <div *ngIf="this.noCommentary" class="alert alert-info" role="alert">
                No commentary is available for this fragment.
            </div>
            <!-- Show all the commentary fields -->
            <div *ngIf="this.noCommentary === false">
                <div *ngFor="let item of this.F_Translation">
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                <b>Fragment Translation</b>
                            </mat-panel-title>
                        </mat-expansion-panel-header>
                        <!-- Commentary with HTML formatting. -->
                        <div class="mat-expansion-panel-content">
                            <div class="mat-expansion-panel-body">
                                <div [innerHTML]="item.translation"></div>
                            </div>
                        </div>
                    </mat-expansion-panel>
                </div>
        
                <hr>
        
                <div *ngFor="let item of this.F_Apparatus">
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                <b>Apparatus Criticus</b>
                            </mat-panel-title>
                        </mat-expansion-panel-header>
                        <div class="mat-expansion-panel-content">
                            <div class="mat-expansion-panel-body">
                                <div [innerHTML]=item.apparatus></div>
                            </div>
                        </div>
                    </mat-expansion-panel>
                </div>
        
                <hr>
        
                <div *ngFor="let item of this.F_Differences">
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                <b>Editorial Differences</b> <!-- -->
                            </mat-panel-title>
                        </mat-expansion-panel-header>
                        <div class="mat-expansion-panel-content">
                            <div class="mat-expansion-panel-body">
                                <div [innerHTML]="item.differences"></div>
                            </div>
                        </div>
                    </mat-expansion-panel>
                </div>
        
                <hr>
        
                <div *ngFor="let item of this.F_Context">
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                <b>Citation Context</b> <!--Citation Context -->
                            </mat-panel-title>
                            <div [innerHTML]="item.contextAuthor"></div><div class="div-padding-sm"></div>
                        </mat-expansion-panel-header>
                        <div class="mat-expansion-panel-content">
                            <div class="mat-expansion-panel-body">
                                <div [innerHTML]="item.context"></div>
                            </div>
                        </div>
                    </mat-expansion-panel>
                </div>
                
                <hr>
        
                <div *ngFor="let item of this.F_Commentary">
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                        <mat-panel-title>
                            <b>Fragment Commentary</b>
                        </mat-panel-title>
                        </mat-expansion-panel-header>
                        <div class="mat-expansion-panel-content">
                        <div class="mat-expansion-panel-body">
                            <div [innerHTML]="item.commentary"></div>
                        </div>
                        </div>
                    </mat-expansion-panel>
                </div>
        
                <hr>
        
                <div *ngFor="let item of this.F_Reconstruction">
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                <b>Fragment Reconstruction</b>
                            </mat-panel-title>
                        </mat-expansion-panel-header>
                        <div class="mat-expansion-panel-content">
                            <div class="mat-expansion-panel-body">
                                <div [innerHTML]="item.reconstruction"></div>
                            </div>
                        </div>
                    </mat-expansion-panel>
                </div>
            </div>
        </div>
        <hr>
    </div> <!-- This closes the first row. Other items will be put under this row -->
    

    <!-- Row to show the playground -->
    <div class="container-fluid" *ngIf="playground_column">
        <div class="row">
            <!-- Possiblity to select an editor to begin with -->
            <mat-form-field class="select-form">
                <mat-label>Editor</mat-label>
                <mat-select [(ngModel)]="selectedEditor">
                    <mat-option *ngFor="let data of this.editorsJSON" [value]="data"
                        (click)="this.playground.playgroundArray = CreateEditorArray(data, this.F_Fragments)"
                        (click)="this.playground.fragmentNumberList2 = this.utility.GetFragmentNumbers(data.id, this.playground.playgroundArray)">
                        {{ data.name }}                       
                    </mat-option>
                </mat-select>
                <mat-hint>Select an editor to begin</mat-hint>
            </mat-form-field>
            <!-- Possiblity to select an editor to add a single fragment from  -->
            <mat-form-field class="select-form">
                <mat-label>Editor</mat-label>
                    <mat-select [(ngModel)]="toAddEditor">
                        <mat-option *ngFor="let data of this.editorsJSON" [value]="data"
                            (click)="this.playground.playgroundArray2 = CreateEditorArray(data, this.F_Fragments)"
                            (click)="this.playground.fragmentNumberList22 = this.utility.GetFragmentNumbers(data.id, this.playground.playgroundArray2)">
                            {{ data.name }}                       
                        </mat-option>
                    </mat-select>
                <mat-hint>Select an editor to add a fragment from</mat-hint>
            </mat-form-field>
            <!-- Possibility to select a fragment from given editor -->
            <mat-form-field class="select-form">
                <mat-label>Fragment</mat-label>
                <mat-select [(ngModel)]="selectedFragment">
                    <mat-option *ngFor="let data of this.playground.fragmentNumberList22" [value]="data"
                        (click)="this.playground.addedArray = this.playground.AddFragmentToArray(this.playground.addedArray, this.playground.playgroundArray2, data)">
                        {{ data }} 
                    </mat-option>
                </mat-select>
                <mat-hint>Select a fragment</mat-hint>
            </mat-form-field> 
            <!-- Possibility to add a little note -->
            <div mat-dialog-content>
                <mat-form-field class="input-form">
                    <input matInput placeholder="Add fragment" [(ngModel)]='note'>
                    <button type="button" mat-icon-button matSuffix (click)="this.noteArray = this.utility.PopArray(this.noteArray)">
                        <mat-icon>{{'remove'}}</mat-icon>
                    </button>
                    <!-- FIXME: this needs to be fixed. I swapped functions, but this doesnt work at all like this -->
                    <button type="button" mat-icon-button matSuffix (click)="this.noteArray = this.utility.CreateOwnFragment(note, this.noteArray, [], '')">
                        <mat-icon>{{'add'}}</mat-icon>
                    </button>
                    <mat-hint>Add own fragment</mat-hint>
                </mat-form-field>               
            </div>  
        </div>

        <hr>
        <!-- For loop to print all the base selected fragments -->
        <div class="row">
            <div *ngFor="let arrayItem of this.playground.playgroundArray" class="playground" cdkDrag>
                <b>Fragment {{arrayItem.fragmentName}}</b> &nbsp; <i>{{arrayItem.status}}</i>
                <div *ngFor="let item of arrayItem.content">           
                    <div [innerHTML]="item.lineComplete"></div>
                </div> 
            </div>
        </div>

        <hr>
        <!-- For loop to print the added fragments -->
        <div class="row">
            <div *ngFor="let arrayItem of this.playground.addedArray" class="playground" cdkDrag>
                <b>(Added) Fragment {{arrayItem.fragmentName}}</b> &nbsp; <i>{{arrayItem.status}}</i>
                <div *ngFor="let item of arrayItem.content">           
                    <div [innerHTML]="item.lineComplete"></div>
                </div> 
            </div>
        </div>
        
        <hr>
        <!-- For loop to print the notes -->
        <div class="row">
            <div *ngFor="let arrayItem of this.noteArray" class="playground" cdkDrag>
                <b>(Added) Fragment {{arrayItem.fragmentName}}</b> &nbsp; <i>{{arrayItem.status}}</i>
                <div *ngFor="let item of arrayItem.content">           
                    <div [innerHTML]="item.lineComplete"></div>
                </div> 
            </div>
        </div>
        <hr>
    </div> <!-- Closes the row -->

    <!-- Four Column Mode. TODO: this would be better done with an Angular template -->
    <div *ngIf="fourColumnMode" class="col-sm overflowColumn">
        <div class="row">
            <!-- Column 1 -->
            <div class="col-md-3">
                <mat-form-field class="input-form">
                    <mat-label>Editor 1</mat-label>
                    <mat-select>
                        <mat-option *ngFor="let selectedEditor of this.editorsJSON" [value]="selectedEditor.id"
                            (click)="this.editor1 = CreateEditorArray(selectedEditor, this.F_Fragments)">
                            {{ selectedEditor.name }} 
                        </mat-option>
                    </mat-select>
                    <mat-hint>Select the first editor</mat-hint>
                </mat-form-field>
                <!-- For loop for moveable fragments. Should be clickable. -->
                <div cdkDropList class="fragment-list" (cdkDropListDropped)="this.utility.moveAndDrop($event, this.editor1)">
                    <div class="fragment-box" *ngFor="let arrayItem of this.editor1" cdkDrag>
                    <div> 
                        <!-- TODO: Show editor name behind fragment. Also, show its relation to the TRF. When clicked,
                        load the commentaries for this fragment and that of the corresponding TRF fragment. -->
                        <b>Frg {{arrayItem.fragmentName}}</b> &nbsp; <sup>{{arrayItem.author}}, {{arrayItem.text}}, {{arrayItem.editor}}</sup> &nbsp; <i>{{arrayItem.status}}</i>
                    </div>
                    <div *ngFor="let arrayItem2 of arrayItem.content">           
                        <div [innerHTML]="arrayItem2.lineComplete"></div> 
                    </div>  
                    </div>
                </div>
            </div>
            <!-- Column 2 -->
            <div class="col-md-3">
                <mat-form-field class="input-form">
                    <mat-label>Editor 2</mat-label>
                    <mat-select>
                    <mat-option *ngFor="let selectedEditor of this.editorsJSON" [value]="selectedEditor.id"
                    (click)="this.editor2 = CreateEditorArray(selectedEditor, this.F_Fragments)">
                        {{ selectedEditor.name }} 
                    </mat-option>
                    </mat-select>
                    <mat-hint>Select the second editor</mat-hint>
                </mat-form-field>
                <!-- For loop for moveable fragments. Should be clickable. -->
                <div cdkDropList class="fragment-list" (cdkDropListDropped)="this.utility.moveAndDrop($event, this.editor2)">
                    <div class="fragment-box" *ngFor="let arrayItem of this.editor2" cdkDrag>
                    <div> 
                        <!-- TODO: Show editor name behind fragment. Also, show its relation to the TRF. When clicked,
                        load the commentaries for this fragment and that of the corresponding TRF fragment. -->
                        <b>Frg {{arrayItem.fragmentName}}</b> &nbsp; <sup>{{arrayItem.author}}, {{arrayItem.text}}, {{arrayItem.editor}}</sup> &nbsp; <i>{{arrayItem.status}}</i>
                    </div>
                    <div *ngFor="let arrayItem2 of arrayItem.content">           
                        <div [innerHTML]="arrayItem2.lineComplete"></div> 
                    </div>  
                    </div>
                </div>
            </div>
            <!-- Column 3 -->
            <div class="col-md-3">
                <mat-form-field class="input-form">
                    <mat-label>Editor 3</mat-label>
                    <mat-select>
                    <mat-option *ngFor="let selectedEditor of this.editorsJSON" [value]="selectedEditor.id"
                    (click)="this.editor3 = CreateEditorArray(selectedEditor, this.F_Fragments)">
                        {{ selectedEditor.name }} 
                    </mat-option>
                    </mat-select>
                    <mat-hint>Select the third editor</mat-hint>
                </mat-form-field>
                <!-- For loop for moveable fragments. Should be clickable. -->
                <div cdkDropList class="fragment-list" (cdkDropListDropped)="this.utility.moveAndDrop($event, this.editor3)">
                    <div class="fragment-box" *ngFor="let arrayItem of this.editor3" cdkDrag>
                    <div> 
                        <!-- TODO: Show editor name behind fragment. Also, show its relation to the TRF. When clicked,
                        load the commentaries for this fragment and that of the corresponding TRF fragment. -->
                        <b>Frg {{arrayItem.fragmentName}}</b> &nbsp; <sup>{{arrayItem.author}}, {{arrayItem.text}}, {{arrayItem.editor}}</sup> &nbsp; <i>{{arrayItem.status}}</i>
                    </div>
                    <div *ngFor="let arrayItem2 of arrayItem.content">           
                        <div [innerHTML]="arrayItem2.lineComplete"></div> 
                    </div>  
                    </div>
                </div>
            </div>
            <!-- Column 4 -->            
            <div class="col-md-3">
                <mat-form-field class="input-form">
                    <mat-label>Editor 4</mat-label>
                    <mat-select>
                    <mat-option *ngFor="let selectedEditor of this.editorsJSON" [value]="selectedEditor.id"
                    (click)="this.editor4 = CreateEditorArray(selectedEditor, this.F_Fragments)">
                        {{ selectedEditor.name }} 
                    </mat-option>
                    </mat-select>
                    <mat-hint>Select the fourth editor</mat-hint>
                </mat-form-field>
                <!-- For loop for moveable fragments. Should be clickable. -->
                <div cdkDropList class="fragment-list" (cdkDropListDropped)="this.utility.moveAndDrop($event, this.editor4)">
                    <div class="fragment-box" *ngFor="let arrayItem of this.editor4" cdkDrag>
                    <div> 
                        <!-- TODO: Show editor name behind fragment. Also, show its relation to the TRF. When clicked,
                        load the commentaries for this fragment and that of the corresponding TRF fragment. -->
                        <b>Frg {{arrayItem.fragmentName}}</b> &nbsp; <sup>{{arrayItem.author}}, {{arrayItem.text}}, {{arrayItem.editor}}</sup> &nbsp; <i>{{arrayItem.status}}</i>
                    </div>
                    <div *ngFor="let arrayItem2 of arrayItem.content">           
                        <div [innerHTML]="arrayItem2.lineComplete"></div> 
                    </div>  
                    </div>
                </div>
            </div>            
        </div>
    </div>

    <!-- Section for the multiplayer (done using Google Firebase) -->
    <div class="container-fluid" *ngIf="multiplayer_column">
        <div class="row">
            <!-- Field to select the author. Beware! It changes the author of the entire program -->
            <div mat-dialog-content>
                <mat-form-field>
                    <mat-label>Select author</mat-label>
                    <mat-select>
                    <mat-option *ngFor="let author of this.authorsJSON" [value]="author" 
                        (click)="this.RequestBooks(author.id)" 
                        (click)="this.SetCurrentAuthorData(author)">
                        {{ author.name }} 
                    </mat-option>
                    </mat-select>  
                </mat-form-field> 
                <!-- Field to select the corresponding book -->
                <mat-form-field>
                    <mat-label>Select text</mat-label>
                    <mat-select>
                    <mat-option *ngFor="let book of this.booksJSON" [value]="book" 
                        (click)="RequestEditors(book.id)"
                        (click)="RequestFragments(book.id)"
                        (click)="SetCurrentBookData(book)">
                        {{ book.title }}                
                    </mat-option>
                    </mat-select>
                </mat-form-field> 
            </div>
            <!-- Possibility to select an editor base text -->
            <mat-form-field class="select-form">
                <mat-label>Editor</mat-label>
                <mat-select [(ngModel)]="selectedEditor">
                <mat-option *ngFor="let data of this.editorsJSON" [value]="data"
                (click)="this.SetCurrentEditorData(data.name)"
                (click)="this.multiplayer.list3Array = CreateEditorArray(data, this.F_Fragments)"
                (click)="this.multiplayer.FirebaseTest(data.name)">
                    {{ data.name }}                       
                </mat-option>
                </mat-select>
                <mat-hint>Select an editor to use</mat-hint>
            </mat-form-field>
            <!-- Possibility to create one's own fragment -->
            <div mat-dialog-content>
                <mat-form-field class="input-form-wide">
                    <input class="input-form-wide" matInput type="text" [(ngModel)]='fragment2Header' [matKeyboard]="'OSCC'">
                    <mat-hint>Add custom header</mat-hint>
                </mat-form-field>               
            </div> 
            <div mat-dialog-content>
                <mat-form-field class="input-form-wide">
                    <input class="input-form-wide" matInput type="text" [(ngModel)]='fragment2' [matKeyboard]="'OSCC'">
                        <button type="button" mat-icon-button matSuffix (click)="this.multiplayer.list4Array = this.utility.CreateOwnFragment(fragment2, fragment2Header, this.multiplayer.list4Array, false)">
                            <mat-icon>{{'text_snippet'}}</mat-icon>
                        </button>
                        <button type="button" mat-icon-button matSuffix (click)="this.multiplayer.list4Array = this.utility.CreateOwnFragment(fragment2, fragment2Header, this.multiplayer.list4Array, true)">
                            <mat-icon>{{'note_add'}}</mat-icon>
                        </button>
                    <mat-hint>Add custom body</mat-hint>
                </mat-form-field>               
            </div> 
            <!-- Possibility to restore and create sessions -->
            <div mat-dialog-content>
                <mat-form-field class="input-form-wide">
                    <input class="input-form-wide" matInput type="text" [(ngModel)]='this.multiplayer.sessionCode' [matKeyboard]="'OSCC'">
                    <button type="button" mat-icon-button matSuffix (click)="this.multiplayer.RestoreFirebaseSession(this.multiplayer.sessionCode)">
                        <mat-icon>{{'restore'}}</mat-icon>
                    </button>
                    <button type="button" mat-icon-button matSuffix (click)="this.multiplayer.CreateFirebaseSession(this.multiplayer.tableName)">
                        <mat-icon>{{'add'}}</mat-icon>
                    </button>
                    <button type="button" mat-icon-button matSuffix (click)="this.multiplayer.RequestDeleteSession(this.multiplayer.sessionCode)">
                        <mat-icon>{{'remove'}}</mat-icon>
                    </button>
                    <mat-hint>Provide your session code</mat-hint>
                </mat-form-field>               
            </div> 

            <mat-checkbox [(ngModel)]="this.multiplayer.showFragmentname">Headers</mat-checkbox>

        </div>

        <hr>
        <!-- Row to show the commentaries. List1 and List2 are synced with the server.
        List3 shows the selected existing edition, List4 one's own comments. -->
        <div class="row">
            <div class="col-md-4">
                <div class="multiplayer-container">
                    <h3>Synced Column 1</h3>
                    <div
                        cdkDropList
                        #list1="cdkDropList"
                        [cdkDropListData]="this.multiplayer.list1Array"
                        [cdkDropListConnectedTo]="[list2, list3, list4, list5, list6]"
                        class="multiplayer-list"
                        (cdkDropListDropped)="this.multiplayer.MultipleColumnsDrag($event)">
                        <div class="fragment-box" *ngFor="let item of this.multiplayer.list1Array" cdkDrag>                          
                            <div class="divNote" *ngIf="item.note"> <!--If it is a note, don't show frg-->
                                <b>{{item.fragmentName}}</b>
                            </div>
                            <div *ngIf="item.note != true && this.multiplayer.showFragmentname">
                                <b>Frg {{item.fragmentName}}</b> &nbsp; <sup>{{item.author}}, {{item.text}}, {{item.editor}}</sup> &nbsp; <i>{{item.status}}</i>
                            </div>
                            <div *ngFor="let item2 of item.content"> 
                                <!-- Keep in mind whether a note is printed or not. -->
                                <div class="divNote" *ngIf="item.note" [innerHTML]="item2.lineComplete"></div> 
                                <div *ngIf="item.note != true" [innerHTML]="item2.lineComplete"></div> 
                            </div>  
                        </div>  
                    </div>
                </div>
            </div>
           <!-- The second list to be synced -->
            <div class="col-md-4">          
                <div class="multiplayer-container">
                    <h3> Synced Column 2</h3>
                    <div
                        cdkDropList
                        #list2="cdkDropList"
                        [cdkDropListData]="this.multiplayer.list2Array"
                        [cdkDropListConnectedTo]="[list1, list3, list4, list5, list6]"
                        class="multiplayer-list"
                        (cdkDropListDropped)="this.multiplayer.MultipleColumnsDrag($event)">
                        <div class="fragment-box" *ngFor="let item of this.multiplayer.list2Array" cdkDrag>                          
                            <div class="divNote" *ngIf="item.note"> <!--If it is a note, don't show frg-->
                                <b>{{item.fragmentName}}</b>
                            </div>
                            <div *ngIf="item.note != true && this.multiplayer.showFragmentname">
                                <b>Frg {{item.fragmentName}}</b> &nbsp; <sup>{{item.author}}, {{item.text}}, {{item.editor}}</sup> &nbsp; <i>{{item.status}}</i>
                            </div>
                            <div *ngFor="let item2 of item.content"> 
                                <!-- Keep in mind whether a note is printed or not. -->
                                <div class="divNote" *ngIf="item.note" [innerHTML]="item2.lineComplete"></div> 
                                <div *ngIf="item.note != true" [innerHTML]="item2.lineComplete"></div> 
                            </div>  
                        </div>   
                    </div>
                </div> 
            </div> 

            <!-- The third column contains two rows: one for own fragments, one for existing editions -->
            <div class="col-md-4">
                <div class="row">
                    <div class="multiplayer-container">
                        <h3>Recycle Bin</h3>
                        <div
                            cdkDropList
                            #list5="cdkDropList"
                            [cdkDropListData]="this.multiplayer.list5Array"
                            [cdkDropListConnectedTo]="[list1, list2, list3, list4, list6]"
                            class="multiplayer-list"
                            (cdkDropListDropped)="this.multiplayer.MultipleColumnsDrag($event)">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="multiplayer-container">
                        <h3>My Notebook</h3>
                        <div
                            cdkDropList
                            #list4="cdkDropList"
                            [cdkDropListData]="this.multiplayer.list4Array"
                            [cdkDropListConnectedTo]="[list1, list2, list3, list5, list6]"
                            class="multiplayer-list"
                            (cdkDropListDropped)="this.multiplayer.MultipleColumnsDrag($event)">
                            <div class="fragment-box" *ngFor="let item of this.multiplayer.list4Array" cdkDrag>                          
                                <div class="divNote" *ngIf="item.note"> <!--If it is a note, don't show frg-->
                                    <b>{{item.fragmentName}}</b>
                                </div>
                                <div *ngIf="item.note != true && this.multiplayer.showFragmentname">
                                    <b>Frg {{item.fragmentName}}</b> &nbsp; <sup>{{item.author}}, {{item.text}}, {{item.editor}}</sup> &nbsp; <i>{{item.status}}</i>
                                </div>
                                <div *ngFor="let item2 of item.content"> 
                                    <!-- Keep in mind whether a note is printed or not. -->
                                    <div class="divNote" *ngIf="item.note" [innerHTML]="item2.lineComplete"></div> 
                                    <div *ngIf="item.note != true" [innerHTML]="item2.lineComplete"></div> 
                                </div>  
                            </div>  
                        </div>
                    </div>
                </div>
                <!-- Last list that shows existing editions -->
                <div class="row">
                    <div class="multiplayer-container">
                        <h3>Existing Edition</h3>
                        <div
                            cdkDropList
                            #list3="cdkDropList"
                            [cdkDropListData]="this.multiplayer.list3Array"
                            [cdkDropListConnectedTo]="[list1, list2, list4, list5, list6]"
                            class="multiplayer-list"
                            (cdkDropListDropped)="this.multiplayer.MultipleColumnsDrag($event)">
                            <div class="fragment-box" *ngFor="let item of this.multiplayer.list3Array" cdkDrag>                          
                                <div class="divNote" *ngIf="item.note"> <!--If it is a note, don't show frg-->
                                    <b>{{item.fragmentName}}</b>
                                </div>
                                <div *ngIf="item.note != true && this.multiplayer.showFragmentname">
                                    <b>Frg {{item.fragmentName}}</b> &nbsp; <sup>{{item.author}}, {{item.text}}, {{item.editor}}</sup> &nbsp; <i>{{item.status}}</i>
                                </div>
                                <div *ngFor="let item2 of item.content"> 
                                    <!-- Keep in mind whether a note is printed or not. -->
                                    <div class="divNote" *ngIf="item.note" [innerHTML]="item2.lineComplete"></div> 
                                    <div *ngIf="item.note != true" [innerHTML]="item2.lineComplete"></div> 
                                </div>  
                            </div> 
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> 
</div>
    
    
    